<!DOCTYPE html>

<html>
<head>
<title>Third Party</title>
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.0/css/bootstrap.min.css">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.0/css/bootstrap-theme.min.css">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.0/js/bootstrap.min.js"></script>
</head>
<body>

<div class=container-fluid><h3>getAccountTokens</h3></div>

<div class=container>
<p>This is the first step to authenticate an account.</p>

<p>The MDN in this API call MUST NOT contain a leading "1". </p>
</div>

<div class=container-fluid>
<table>
<tr>
  <td bgcolor='#e8e8e8'>
    URL
  </td>
  <td>
    /wsg/public/nab/v3/{mdn}/account/tokens
  </td>
</tr>
<tr><td colspan=2>&nbsp;</td></tr>
<tr>
  <td bgcolor='#e8e8e8'>
    Method
  </td>
  <td>
    GET
  </td>
</tr>
<tr><td colspan=2>&nbsp;</td></tr>
<tr>
  <td bgcolor='#e8e8e8'>
    Headers
  </td>
  <td>

    <table border=1>
      <tr>
        <td>Content-Type:</td>
        <td>
          application/xml
        </td>
      </tr>
      <tr>
        <td>Authorization-Domain:</td>
        <td>
          <ul>
          <li>vzw.portal.sso - If authorizing over the internet</li>
          <li>vzw.device.sso - If authorizing over the radio net</li>
          </ul>
        </td>
      </tr>
      <tr>
        <td>Authorization:</td>
        <td>
          <ul>
          <li>This is using the Basic auth method</li>
          <li>This is a base64 encoding of the user's MDN and password
          in the format base64("mdn:pass").</li>
          </ul>
<pre class="example">$ echo -n '7325551234:1234' | base64
NzMyNTU1MTIzNDoxMjM0
</pre>
        </td>
      </tr>
      <tr>
        <td>X-F1-Client-Authorization:</td>
        <td>
          <ul>
          <li>YzJoaGNtVmtMbkJvYjI1bExtTnZiblJsYm5Sb2RXSTZZMjl1ZEdWdWRHaDFZbDl3YUc5dVpWOWpiR2xsYm5RPTpCYWw2b2trNm82OFJQWjJmVjJqZnNJZmRBWVV4OVU2QlhINDVrM2ZZdWdo
          [TODO what is this?]</li>
          </ul>
        </td>
      </tr>

<tr>
<td>x-application-identifier</td>
<td>unique device identifier. Must match X-SNCR-APP-ID.</td>
</tr>
<tr>
<td>X-SNCR-APP-ID</td>
<td>unique device identifier. Must match x-application-identifier.</td>
</tr>
<tr>
<td>X-SNCR-Client-Version</td>
<td>Version number of the client</td>
</tr>
<tr>
<td>X-SNCR-Client-Platform</td>
<td>TP [TODO] (thought this was only PC, HANDSET, WEB)</td>
</tr>


    </table>

  </td>
</tr>
</table>
</div>

<div class=container-fluid>
<h4>Example Usage:</h4>
</div>
<div class=container>
<pre class="example">mdn=7325551234
authToken=`echo -n "$mdn:1234" | base64`

$ curl -s -X GET
  http://pegqalb-wsg.fusionone.com:1080/wsg/public/nab/v3/${mdn}/account/tokens
  \
-H "Authorization-Domain: vzw.portal.sso"   \
-H "Content-Type: application/xml"   \
-H "X-F1-Client-Authorization: Basic
  YzJoaGNtVmtMbkJvYjI1bExtTnZiblJsYm5Sb2RXSTZZMjl1ZEdWdWRHaDFZbDl3YUc5dVpWOWpiR2xsYm5RPTpCYWw2b2trNm82OFJQWjJmVjJqZnNJZmRBWVV4OVU2QlhINDVrM2ZZdW\
do"   \
-H "Authorization: Basic ${authToken}" \
-H "x-application-identifier: TP.${mdn}" \
-H "X-SNCR-APP-ID: TP.${mdn}" \
-H "X-SNCR-Client-Version : 13.2.0.1" \
-H "X-SNCR-Client-Platform: TP"
</pre>


<p>
The response to this will depend on the status of the account but it
will look something like this:
</p>



<pre class="example">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;ns1:account-tokens-get-response
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xmlns:ns1="http://www.fusionone.com/xmlns/f1" userid="17325551234"
  type="MDN" xsi:schemaLocation="GetAccountTokens.xsd"&gt;
  &lt;ns1:status&gt;
    &lt;ns1:code&gt;4000&lt;/ns1:code&gt;
    &lt;ns1:msg&gt;Success&lt;/ns1:msg&gt;
  &lt;/ns1:status&gt;
  &lt;ns1:nabtoken&gt;AL0eSuOv8xkDMZrw02WfFU5K-fXma3U5WrB8wlSF3JA5avT6t92plMA8T_5L-yty5mKEiMvqE7zxrZd6dbANMPpwBgAFHDNjOPojLJ7Lmv3T7-tWqy1ap4iSdlR1oMH6uzNIUN85CdZf9YQPcaao-C_S2qRPKz1aZLT6jTo8jpfoTOnm1h3s32ofYazYzgQGPdQQE3-LN3cweJ7XIbSgDOw~&lt;/ns1:nabtoken&gt;
  &lt;ns1:dvtoken&gt;AL0eSuOv8xkDMZrw02WfFU5K-fXma3U5WrB8wlSF3JA5avT6t92plMA8T_5L-yty5mKEiMvqE7zxrZd6dbANMPpwBgAFHDNjOPojLJ7Lmv3T7-tWqy1ap4iSdlR1oMH6uzNIUN85CdZf9YQPcaao-C_S2qRPKz1aZLT6jTo8jpfoTOnm1h3s32ofYazYzgQGPdQQE3-LN3cweJ7XIbSgDOw~&lt;/ns1:dvtoken&gt;
  &lt;ns1:refreshtoken&gt;rqM1215p74BU0bPGa2zjUVU8P7Y8y1Yb&lt;/ns1:refreshtoken&gt;
  &lt;ns1:locationuri&gt;http://ont-api-dc1-external-vip.hs1.newbayasp.net/snc-conf/snc-config&lt;/ns1:locationuri&gt
  &lt;ns1:lcid&gt;0bb4ac60692f4b7c9d915352ffb38439&lt;/ns1:lcid&gt;
&lt;/ns1:account-tokens-get-response&gt;
</pre>


<p>
The 4 main fields to take note of are: nabtoken, dvtoken,
refreshtoken, and lcid.
</p>
<ul>
<li>The "lcid" is the user's account number internal to Synchronoss.
</li>
<li>The "refreshtoken" is the media long token which is valid for 14
  days.
</li>
<li>The "dvtoken" is the media short token and is good for 9 hours. If
  this expires, you will need to use the "refresh" call below to get a
  new one.
</li>
<li>The "nabtoken" is for contact sync and is valid for 30 days.
</li>
</ul>
</div>

</body>
</html>
